---
title: "Analysis of VOC concentrations between sites"
author: "Paige Varner"
date: "2024-06-05"
output: html_document
---

#load libraries and data
```{r}
library("dplyr")
library("bigrquery")
library("DBI")
library("pheatmap")
library("RColorBrewer")
library("Rmisc")
library("stats")
library("rstatix")
library("ggplot2")
library("tidyr")
library("car")
library("janitor")
library("dunn.test")
library("sf")
detach(package:Rmisc)
detach(package:plyr)

ozone = read.csv("~/CO_CRA/CO_CRA/Data/Ozone8hour2018to2023.csv")
anthem = read.csv("~/CO_CRA/CO_CRA/Data/weekly_Anthem.csv")
commons = read.csv("~/CO_CRA/CO_CRA/Data/weekly_Commons.csv")
ica = read.csv("~/CO_CRA/CO_CRA/Data/weekly_ICA.csv")
icb = read.csv("~/CO_CRA/CO_CRA/Data/weekly_ICB.csv")
livingston = read.csv("~/CO_CRA/CO_CRA/Data/weekly_Livingston.csv")
nwa = read.csv("~/CO_CRA/CO_CRA/Data/weekly_NWA.csv")
nwb = read.csv("~/CO_CRA/CO_CRA/Data/weekly_NWB.csv")
united = read.csv("~/CO_CRA/CO_CRA/Data/weekly_United.csv")
wildgrass = read.csv("~/CO_CRA/CO_CRA/Data/weekly_Wildgrass.csv")
```


#combine all sites and format
```{r}
#add location name to each df to separate later
anthem$Sampling.Site = "Anthem"
commons$Sampling.Site = "Commons"
ica$Sampling.Site = "Interchange A"
icb$Sampling.Site = "Interchange B"
livingston$Sampling.Site = "Livingston"
nwa$Sampling.Site = "Northwest A"
nwb$Sampling.Site = "Northwest B"
united$Sampling.Site = "United"
wildgrass$Sampling.Site = "Wildgrass"

#combine
all = bind_rows(anthem, commons, ica, icb, livingston, nwa, nwb, united, wildgrass)

#fix chemical columns and their names, and filter for chemicals we're looking at
all$Xylenes = all$o.Xylene + all$m..and.p.Xylene
colnames(all)[colnames(all) == "C2Cl4"] = "PCE"
colnames(all)[colnames(all) == "C2HCl3"] = "TCE"

#add chemical concentrations together for aliphatic low and aromatic medium groups
all$Aliphatic_low = all$n.Octane + all$i.Pentane + all$n.Pentane + all$trans.2.Pentene + all$X1.Pentene + all$cis.2.Pentene + all$n.Hexane + all$Isoprene + all$X2.4.Dimethylpentane + all$n.Heptane + all$Cyclohexane + all$X2.3.Dimethylpentane + all$X2.Methylhexane + all$X3.Methylhexane + all$X2.2.4.Trimethylpentane + all$Methylcyclohexane + all$X2.3.4.Trimethylpentane + all$X2.Methylheptane + all$X3.Methylheptane + all$Cycopentane

all$Aromatic_medium = all$i.Propylbenzene + all$n.Propylbenzene + all$X3.Ethyltoluene + all$X4.Ethyltoluene + all$X1.3.5.Trimethylbenzene + all$X2.Ethyltoluene + all$X1.2.4.Trimethylbenzene + all$X1.2.3.Trimethylbenzene + all$X1.3.Diethylbenzene + all$X1.4.Diethylbenzene

all_clean = all %>%
  select(Sampling.Site, Phase, Mud, Benzene, Toluene, Ethylbenzene, Xylenes, n.Octane, n.Nonane, n.Decane, Aliphatic_low, Aromatic_medium, Styrene, TCE, PCE, Propene)

#transform to long for graphing and analysis
all_long = all_clean %>%
  pivot_longer(cols = c("Benzene", "Toluene", "Ethylbenzene", "Xylenes", "n.Nonane", "n.Decane", "Aliphatic_low", "Aromatic_medium", "Styrene", "TCE", "PCE", "Propene"), names_to = "Chemical", values_to = "Value") 

#order phases and chemicals for best graphing
all_long$Phase[is.na(all_long$Phase)] = "none"

all_long$Phase = factor(all_long$Phase, levels = c("drilling", "pre", "prod", "none"))

all_long$Chemical = factor(all_long$Chemical, levels = c("Benzene", "Toluene", "Ethylbenzene", "Xylenes", "Styrene", "n.Nonane", "n.Decane",  "TCE", "PCE", "Propene", "Aliphatic_low", "Aromatic_medium"))


```



#violin plots for phase of O&G on the x axis (highlighting differences between phases for different chemicals at all sites or different sites) only for pad locations

```{r}
#select data for pad locations only and commons only
pads = all_long %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United")

pads$Phase <- factor(pads$Phase, levels = c("drilling", "pre", "prod"))

commons_long = all_long %>%
  filter(Sampling.Site == "Commons")

commons_long$Phase = "Commons"

# Combine the pads and commons_long dataframes
combined_data <- rbind(pads, commons_long)

#all sites, faceted by chemical, with phases on the x axis

VOCs_violin_pads_commons = ggplot(combined_data, aes(x = Phase, y = Value, fill = Phase)) +
  geom_violin(trim = FALSE) +
  theme_bw() +
  ylab("Concentration (ppbv)") +
  xlab("Phase") +
  stat_summary(fun = median, geom = "point", shape = 20, size = 1.8, color = "black", fill = "gray") +
  facet_wrap(~ Chemical, scales = "free", ncol = 4, nrow = 3) +
  scale_fill_manual(values = c("Drilling" = "black", "Pre" = "black", "Prod" = "black", "Commons" = "royalblue")) +
  scale_x_discrete(labels = c("drilling" = "Drilling", "pre" = "Well Completions", "prod" = "Production", "Commons" = "Background")) +
  theme(legend.position = "none",
        strip.text = element_text(size = 14)) +
  theme(axis.text.x = element_text(size = 14, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 14),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16),
        legend.text = element_text(size = 14),
        legend.title = element_text(size = 16),
        plot.title = element_text(size = 18))

VOCs_violin_pads_commons

ggsave(filename = "pads_commons_violin.png", device = "png", plot = VOCs_violin_pads_commons, path = "~/CO_CRA/CO_CRA/Output/Air_Data/", width = 13, height = 10)

```



#violin plots for community monitors (anthem and wildgrass)
```{r}
#select data for community locations only
comm = all_long %>%
  filter(Sampling.Site == "Anthem" | Sampling.Site == "Wildgrass")

#all sites, faceted by chemical, with phases on the x axis

VOCs_violin_comm = ggplot(comm, aes(x = Phase, y = Value)) + geom_violin(trim = FALSE) + theme_bw() + ylab("Concentration (ppb)") + xlab("Phase") + theme(axis.text.x = element_text(size = 10, angle = 45, hjust = 1)) + stat_summary(fun = mean, geom = "point", shape = 20, size = 1, color = "black", fill = "gray") + facet_wrap(~ Chemical, scales = "free") + scale_x_discrete(labels = c("drilling" = "Drilling", "pre" = "Pre-prod.", "prod" = "Prod.", "none" = "None"))

VOCs_violin_comm = ggplot(comm, aes(x = Phase, y = Value)) +
  geom_violin(trim = FALSE, fill = "gray50") +
  theme_bw() +
  ylab("Concentration (ppbv)") +
  xlab("Phase") +
  stat_summary(fun = median, geom = "point", shape = 20, size = 1.8, color = "black", fill = "gray") +
  facet_wrap(~ Chemical, scales = "free", ncol = 4, nrow = 3) +
  scale_x_discrete(labels = c("drilling" = "Drilling", "pre" = "Well Completions", "prod" = "Production", "none" = "None")) +
  theme(legend.position = "none",
        strip.text = element_text(size = 14)) +
  theme(axis.text.x = element_text(size = 14, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 14),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16),
        legend.text = element_text(size = 14),
        legend.title = element_text(size = 16),
        plot.title = element_text(size = 18))

VOCs_violin_comm

ggsave(filename = "comm_violin.png", device = "png", plot = VOCs_violin_comm, path = "~/CO_CRA/CO_CRA/Output/Air_Data/", width = 10, height = 10)

```




#violin plots for mud on the x axis (highlighting differences between muds different chemicals) for O&G sites

```{r}
#remove NAs for mud and only look at O&G sites
mud_only = all_long %>%
  filter(Mud == "neoflow" | Mud == "gibson") %>%
   filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United")

mud_violin = ggplot(mud_only, aes(x = Mud, y = Value)) +
  geom_violin(trim = FALSE, fill = "gray50") +
  theme_bw() +
  ylab("Concentration (ppbv)") +
  xlab("Drill Mud") +
  stat_summary(fun = median, geom = "point", shape = 20, size = 1.8, color = "black", fill = "gray") +
  facet_wrap(~ Chemical, scales = "free", ncol = 4, nrow = 3) +
  scale_x_discrete(labels = c("neoflow" = "Neoflo", "gibson" = "Gibson")) +
  theme(legend.position = "none",
        strip.text = element_text(size = 14),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 14),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16),
        legend.text = element_text(size = 14),
        legend.title = element_text(size = 16),
        plot.title = element_text(size = 18))

mud_violin

ggsave(filename = "mud_violin.png", device = "png", plot = mud_violin, path = "~/CO_CRA/CO_CRA/Output/Air_Data/", width = 13, height = 10)
```


#dotplot for mud on the x axis (highlighting differences between muds but also which sites are contributing)
```{r}
mud_only = all_long %>%
  filter(Mud == "neoflow" | Mud == "gibson") %>%
   filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United")

medians <- mud_only %>%
  group_by(Chemical, Mud) %>%
  summarize(median_value = median(Value, na.rm = TRUE), .groups = 'drop')

mud_dotplot <- ggplot(mud_only, aes(x = Mud, y = Value, fill = Sampling.Site)) +
  geom_dotplot(binaxis = 'y', stackdir = 'center', dotsize = 0.7, stroke = 0) +  # Make the outline the same color as the fill
  scale_fill_manual(values = c("Interchange A" = "blue", "Interchange B" = "green", "Livingston" = "red", "Northwest A" = "orange", "Northwest B" = "violet", "United" = "yellow")) +  # Customize colors
  geom_crossbar(data = medians, aes(x = Mud, y = median_value, ymin = median_value, ymax = median_value), inherit.aes = FALSE, color = "black", width = 0.5) +  # Add black line for median
  theme_bw() +
  ylab("Concentration (ppbv)") +
  xlab("Drill Mud") +
  facet_wrap(~ Chemical, scales = "free", ncol = 4, nrow = 3) +
  scale_x_discrete(labels = c("neoflow" = "Neoflo", "gibson" = "Gibson")) +
  theme(legend.position = "right",
        strip.text = element_text(size = 14),
        axis.text.x = element_text(size = 14, angle = 45, hjust = 1),
        axis.text.y = element_text(size = 14),
        axis.title.x = element_text(size = 16),
        axis.title.y = element_text(size = 16),
        legend.text = element_text(size = 14),
        legend.title = element_text(size = 16),
        plot.title = element_text(size = 18))

mud_dotplot

ggsave(filename = "mud_dotplot.png", device = "png", plot = mud_dotplot, path = "~/CO_CRA/CO_CRA/Output/Air_Data/", width = 13, height = 10)
```





## Statistics ##


## ANOVA per chemical to compare between site and phase for O&G sites

#benzene
```{r}
#clean data and filter for benzene
all_clean$Phase[is.na(all_clean$Phase)] = "commons"

ben = all_clean %>%
  select(Sampling.Site, Phase, Mud, Benzene) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

ben$Sampling.Site <- as.factor(ben$Sampling.Site)
ben$Phase <- as.factor(ben$Phase)

#run ANOVA
ben_anova = aov(Benzene ~ Sampling.Site*Phase, data = ben)
summary(ben_anova)

#Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(ben_anova$residuals)

#Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Benzene ~ Sampling.Site * Phase, data = ben)

#log-transform and check distribution with histogram and tests
ben$log_Benzene <- log(ben$Benzene)
hist(ben$log_Benzene)
leveneTest(log_Benzene ~ Sampling.Site * Phase, data = ben) #reduced by orders of magnitude, so good enough

#re-run ANOVA with transformed values
ben_anova = aov(log_Benzene ~ Sampling.Site*Phase, data = ben)
summary(ben_anova)
capture.output(ben_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/benzene_anova_OG")

#tukey's post-hoc
ben_tukey = TukeyHSD(x = ben_anova, conf.level = 0.95)
capture.output(ben_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/benzene_tukey_OG")
ben_tukey


```


#toluene
```{r}
#clean data and filter for toluene
tol = all_clean %>%
  select(Sampling.Site, Phase, Mud, Toluene) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

tol$Sampling.Site <- as.factor(tol$Sampling.Site)
tol$Phase <- as.factor(tol$Phase)

#run ANOVA
tol_anova = aov(Toluene ~ Sampling.Site*Phase, data = tol)
summary(tol_anova)

#Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(tol_anova$residuals)

#Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Toluene ~ Sampling.Site * Phase, data = tol)

#log-transform and check distribution with histogram and tests
tol$log_Toluene <- log(tol$Toluene)
hist(tol$log_Toluene)
leveneTest(log_Toluene ~ Sampling.Site * Phase, data = tol) #reduced by orders of magnitude, so good enough

#re-run ANOVA with transformed values
tol_anova = aov(log_Toluene ~ Sampling.Site*Phase, data = tol)
summary(tol_anova)
capture.output(tol_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/toluene_anova_OG")

#tukey's post-hoc
tol_tukey = TukeyHSD(x = tol_anova, conf.level = 0.95)
capture.output(tol_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/toluene_tukey_OG")
tol_tukey
```


# Ethylbenzene
```{r}
# Clean data and filter for Ethylbenzene
eb = all_clean %>%
  select(Sampling.Site, Phase, Mud, Ethylbenzene) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

eb$Sampling.Site <- as.factor(eb$Sampling.Site)
eb$Phase <- as.factor(eb$Phase)

# Run ANOVA
eb_anova = aov(Ethylbenzene ~ Sampling.Site * Phase, data = eb)
summary(eb_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(eb_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Ethylbenzene ~ Sampling.Site * Phase, data = eb)

# Log-transform and check distribution with histogram and tests
eb$log_Ethylbenzene <- log(eb$Ethylbenzene)
hist(eb$log_Ethylbenzene)
leveneTest(log_Ethylbenzene ~ Sampling.Site * Phase, data = eb) # not significant anymore

# Re-run ANOVA with transformed values
eb_anova = aov(log_Ethylbenzene ~ Sampling.Site * Phase, data = eb)
summary(eb_anova)
capture.output(eb_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/ethylbenzene_anova_OG")

# Tukey's post-hoc
eb_tukey = TukeyHSD(x = eb_anova, conf.level = 0.95)
capture.output(eb_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/ethylbenzene_tukey_OG")
eb_tukey
```


# Xylenes
```{r}
# Clean data and filter for Xylenes
xyl = all_clean %>%
  select(Sampling.Site, Phase, Mud, Xylenes) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

xyl$Sampling.Site <- as.factor(xyl$Sampling.Site)
xyl$Phase <- as.factor(xyl$Phase)

# Run ANOVA
xyl_anova = aov(Xylenes ~ Sampling.Site * Phase, data = xyl)
summary(xyl_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(xyl_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Xylenes ~ Sampling.Site * Phase, data = xyl)

# Log-transform and check distribution with histogram and tests
xyl$log_Xylenes <- log(xyl$Xylenes)
hist(xyl$log_Xylenes)
leveneTest(log_Xylenes ~ Sampling.Site * Phase, data = xyl) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
xyl_anova = aov(log_Xylenes ~ Sampling.Site * Phase, data = xyl)
summary(xyl_anova)
capture.output(xyl_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/xylenes_anova_OG")

# Tukey's post-hoc
xyl_tukey = TukeyHSD(x = xyl_anova, conf.level = 0.95)
capture.output(xyl_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/xylenes_tukey_OG")
xyl_tukey
```


# Styrene
```{r}
# Clean data and filter for Styrene
sty = all_clean %>%
  select(Sampling.Site, Phase, Mud, Styrene) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

sty$Sampling.Site <- as.factor(sty$Sampling.Site)
sty$Phase <- as.factor(sty$Phase)

# Run ANOVA
sty_anova = aov(Styrene ~ Sampling.Site * Phase, data = sty)
summary(sty_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(sty_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Styrene ~ Sampling.Site * Phase, data = sty)

# Log-transform and check distribution with histogram and tests
sty$log_Styrene <- log(sty$Styrene)
hist(sty$log_Styrene)
leveneTest(log_Styrene ~ Sampling.Site * Phase, data = sty) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
sty_anova = aov(log_Styrene ~ Sampling.Site * Phase, data = sty)
summary(sty_anova)
capture.output(sty_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/styrene_anova_OG")

# Tukey's post-hoc
sty_tukey = TukeyHSD(x = sty_anova, conf.level = 0.95)
capture.output(sty_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/styrene_tukey_OG")
sty_tukey
```


# n.Nonane
```{r}
# Clean data and filter for n.Nonane
nn = all_clean %>%
  select(Sampling.Site, Phase, Mud, n.Nonane) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

nn$Sampling.Site <- as.factor(nn$Sampling.Site)
nn$Phase <- as.factor(nn$Phase)

# Run ANOVA
nn_anova = aov(n.Nonane ~ Sampling.Site * Phase, data = nn)
summary(nn_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(nn_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(n.Nonane ~ Sampling.Site * Phase, data = nn)

# Log-transform and check distribution with histogram and tests
nn$log_n.Nonane <- log(nn$n.Nonane)
hist(nn$log_n.Nonane)
leveneTest(log_n.Nonane ~ Sampling.Site * Phase, data = nn) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
nn_anova = aov(log_n.Nonane ~ Sampling.Site * Phase, data = nn)
summary(nn_anova)
capture.output(nn_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/n_nonane_anova_OG")

# Tukey's post-hoc
nn_tukey = TukeyHSD(x = nn_anova, conf.level = 0.95)
capture.output(nn_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/n_nonane_tukey_OG")
nn_tukey
```


# n.Decane
```{r}
# Clean data and filter for n.Decane
nd = all_clean %>%
  select(Sampling.Site, Phase, Mud, n.Decane) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

nd$Sampling.Site <- as.factor(nd$Sampling.Site)
nd$Phase <- as.factor(nd$Phase)

# Run ANOVA
nd_anova = aov(n.Decane ~ Sampling.Site * Phase, data = nd)
summary(nd_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(nd_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(n.Decane ~ Sampling.Site * Phase, data = nd)

# Log-transform and check distribution with histogram and tests
nd$log_n.Decane <- log(nd$n.Decane)
hist(nd$log_n.Decane)
leveneTest(log_n.Decane ~ Sampling.Site * Phase, data = nd) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
nd_anova = aov(log_n.Decane ~ Sampling.Site * Phase, data = nd)
summary(nd_anova)
capture.output(nd_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/n_decane_anova_OG")

# Tukey's post-hoc
nd_tukey = TukeyHSD(x = nd_anova, conf.level = 0.95)
capture.output(nd_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/n_decane_tukey_OG")
nd_tukey
```


# TCE
```{r}
# Clean data and filter for TCE
tce = all_clean %>%
  select(Sampling.Site, Phase, Mud, TCE) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

tce$Sampling.Site <- as.factor(tce$Sampling.Site)
tce$Phase <- as.factor(tce$Phase)

# Run ANOVA
tce_anova = aov(TCE ~ Sampling.Site * Phase, data = tce)
summary(tce_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(tce_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(TCE ~ Sampling.Site * Phase, data = tce)

# Log-transform and check distribution with histogram and tests
tce$log_TCE <- log(tce$TCE)
hist(tce$log_TCE)
leveneTest(log_TCE ~ Sampling.Site * Phase, data = tce) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
tce_anova = aov(log_TCE ~ Sampling.Site * Phase, data = tce)
summary(tce_anova)
capture.output(tce_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/tce_anova_OG")

# Tukey's post-hoc
tce_tukey = TukeyHSD(x = tce_anova, conf.level = 0.95)
capture.output(tce_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/tce_tukey_OG")
tce_tukey
```


# PCE
```{r}
# Clean data and filter for PCE
pce = all_clean %>%
  select(Sampling.Site, Phase, Mud, PCE) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

pce$Sampling.Site <- as.factor(pce$Sampling.Site)
pce$Phase <- as.factor(pce$Phase)

# Run ANOVA
pce_anova = aov(PCE ~ Sampling.Site * Phase, data = pce)
summary(pce_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(pce_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(PCE ~ Sampling.Site * Phase, data = pce)

# Log-transform and check distribution with histogram and tests
pce$log_PCE <- log(pce$PCE)
hist(pce$log_PCE)
leveneTest(log_PCE ~ Sampling.Site * Phase, data = pce) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
pce_anova = aov(log_PCE ~ Sampling.Site * Phase, data = pce)
summary(pce_anova)
capture.output(pce_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/pce_anova_OG")

# Tukey's post-hoc
pce_tukey = TukeyHSD(x = pce_anova, conf.level = 0.95)
capture.output(pce_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/pce_tukey_OG")
pce_tukey
```


# Aliphatic_low
```{r}
# Clean data and filter for Aliphatic_low
aliph = all_clean %>%
  select(Sampling.Site, Phase, Mud, Aliphatic_low) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

aliph$Sampling.Site <- as.factor(aliph$Sampling.Site)
aliph$Phase <- as.factor(aliph$Phase)

# Run ANOVA
aliph_anova = aov(Aliphatic_low ~ Sampling.Site * Phase, data = aliph)
summary(aliph_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(aliph_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Aliphatic_low ~ Sampling.Site * Phase, data = aliph)

# Log-transform and check distribution with histogram and tests
aliph$log_Aliphatic_low <- log(aliph$Aliphatic_low)
hist(aliph$log_Aliphatic_low)
leveneTest(log_Aliphatic_low ~ Sampling.Site * Phase, data = aliph) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
aliph_anova = aov(log_Aliphatic_low ~ Sampling.Site * Phase, data = aliph)
summary(aliph_anova)
capture.output(aliph_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/aliphatic_low_anova_OG")

# Tukey's post-hoc
aliph_tukey = TukeyHSD(x = aliph_anova, conf.level = 0.95)
capture.output(aliph_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/aliphatic_low_tukey_OG")
aliph_tukey
```



# Aromatic_medium
```{r}
# Clean data and filter for Aromatic_medium
aro = all_clean %>%
  select(Sampling.Site, Phase, Mud, Aromatic_medium) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

aro$Sampling.Site <- as.factor(aro$Sampling.Site)
aro$Phase <- as.factor(aro$Phase)

# Run ANOVA
aro_anova = aov(Aromatic_medium ~ Sampling.Site * Phase, data = aro)
summary(aro_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(aro_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Aromatic_medium ~ Sampling.Site * Phase, data = aro)

# Log-transform and check distribution with histogram and tests
aro$log_Aromatic_medium <- log(aro$Aromatic_medium)
hist(aro$log_Aromatic_medium)
leveneTest(log_Aromatic_medium ~ Sampling.Site * Phase, data = aro) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
aro_anova = aov(log_Aromatic_medium ~ Sampling.Site * Phase, data = aro)
summary(aro_anova)
capture.output(aro_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/aromatic_medium_anova_OG")

# Tukey's post-hoc
aro_tukey = TukeyHSD(x = aro_anova, conf.level = 0.95)
capture.output(aro_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/aromatic_medium_tukey_OG")
aro_tukey
```


# propene
```{r}
# Clean data and filter for Aromatic_medium
pro = all_clean %>%
  select(Sampling.Site, Phase, Mud, Propene) %>%
  filter(Sampling.Site == "Interchange A" | Sampling.Site == "Interchange B" | Sampling.Site == "Livingston" | Sampling.Site == "Northwest A" | Sampling.Site == "Northwest B" | Sampling.Site == "United" | Sampling.Site == "Commons")

pro$Sampling.Site <- as.factor(pro$Sampling.Site)
pro$Phase <- as.factor(pro$Phase)

# Run ANOVA
pro_anova = aov(Propene ~ Sampling.Site * Phase, data = pro)
summary(pro_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(pro_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Propene ~ Sampling.Site * Phase, data = pro)

# Log-transform and check distribution with histogram and tests
pro$log_Propene <- log(pro$Propene)
hist(pro$log_Propene)
leveneTest(log_Propene ~ Sampling.Site * Phase, data = pro) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
pro_anova = aov(log_Propene ~ Sampling.Site * Phase, data = pro)
summary(pro_anova)
capture.output(pro_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/propene_anova_OG")

# Tukey's post-hoc
pro_tukey = TukeyHSD(x = pro_anova, conf.level = 0.95)
capture.output(pro_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/propene_tukey_OG")
pro_tukey
```


## do all of the above for community sites

# Benzene
```{r}
# Clean data and filter for Benzene
all_clean$Phase[is.na(all_clean$Phase)] = "none"

ben = all_clean %>%
  select(Sampling.Site, Phase, Mud, Benzene) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

ben$Sampling.Site <- as.factor(ben$Sampling.Site)
ben$Phase <- as.factor(ben$Phase)

# Run ANOVA
ben_anova = aov(Benzene ~ Sampling.Site * Phase, data = ben)
summary(ben_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(ben_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Benzene ~ Sampling.Site * Phase, data = ben)

# Log-transform and check distribution with histogram and tests
ben$log_Benzene <- log(ben$Benzene)
hist(ben)
leveneTest(log_Benzene ~ Sampling.Site * Phase, data = ben) # not significant anymore

# Re-run ANOVA with transformed values
ben_anova = aov(log_Benzene ~ Sampling.Site * Phase, data = ben)
summary(ben_anova)
capture.output(ben_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/benzene_anova_comm")

# Tukey's post-hoc
ben_tukey = TukeyHSD(x = ben_anova, conf.level = 0.95)
capture.output(ben_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/benzene_tukey_comm")
ben_tukey
```


#toluene
```{r}
# Clean data and filter for Toluene
tol = all_clean %>%
  select(Sampling.Site, Phase, Mud, Toluene) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

tol$Sampling.Site <- as.factor(tol$Sampling.Site)
tol$Phase <- as.factor(tol$Phase)

# Run ANOVA
tol_anova = aov(Toluene ~ Sampling.Site * Phase, data = tol)
summary(tol_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(tol_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Toluene ~ Sampling.Site * Phase, data = tol)

# Log-transform and check distribution with histogram and tests
tol$log_Toluene <- log(tol$Toluene)
hist(tol)
leveneTest(log_Toluene ~ Sampling.Site * Phase, data = tol) # not sig anymore

# Re-run ANOVA with transformed values
tol_anova = aov(log_Toluene ~ Sampling.Site * Phase, data = tol)
summary(tol_anova)
capture.output(tol_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/toluene_anova_comm")

# Tukey's post-hoc
tol_tukey = TukeyHSD(x = tol_anova, conf.level = 0.95)
capture.output(tol_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/toluene_tukey_comm")
tol_tukey
```


#ethylbenzene
```{r}
# Clean data and filter for Ethylbenzene
eb = all_clean %>%
  select(Sampling.Site, Phase, Mud, Ethylbenzene) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

eb$Sampling.Site <- as.factor(eb$Sampling.Site)
eb$Phase <- as.factor(eb$Phase)

# Run ANOVA
eb_anova = aov(Ethylbenzene ~ Sampling.Site * Phase, data = eb)
summary(eb_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(eb_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Ethylbenzene ~ Sampling.Site * Phase, data = eb)

# Log-transform and check distribution with histogram and tests
eb$log_Ethylbenzene <- log(eb$Ethylbenzene)
hist(eb)
leveneTest(log_Ethylbenzene ~ Sampling.Site * Phase, data = eb) # not significant anymore

# Re-run ANOVA with transformed values
eb_anova = aov(log_Ethylbenzene ~ Sampling.Site * Phase, data = eb)
summary(eb_anova)
capture.output(eb_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/ethylbenzene_anova_comm")

# Tukey's post-hoc
eb_tukey = TukeyHSD(x = eb_anova, conf.level = 0.95)
capture.output(eb_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/ethylbenzene_tukey_comm")
eb_tukey

```


#xylenes
```{r}
# Clean data and filter for Xylenes
xyl = all_clean %>%
  select(Sampling.Site, Phase, Mud, Xylenes) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

xyl$Sampling.Site <- as.factor(xyl$Sampling.Site)
xyl$Phase <- as.factor(xyl$Phase)

# Run ANOVA
xyl_anova = aov(Xylenes ~ Sampling.Site * Phase, data = xyl)
summary(xyl_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(xyl_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Xylenes ~ Sampling.Site * Phase, data = xyl)

# Log-transform and check distribution with histogram and tests
xyl$log_Xylenes <- log(xyl$Xylenes)
hist(xyl)
leveneTest(log_Xylenes ~ Sampling.Site * Phase, data = xyl) # not sig anymore

# Re-run ANOVA with transformed values
xyl_anova = aov(log_Xylenes ~ Sampling.Site * Phase, data = xyl)
summary(xyl_anova)
capture.output(xyl_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/xylenes_anova_comm")

# Tukey's post-hoc
xyl_tukey = TukeyHSD(x = xyl_anova, conf.level = 0.95)
capture.output(xyl_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/xylenes_tukey_comm")
xyl_tukey


```


#styrene
```{r}
# Clean data and filter for Styrene
sty = all_clean %>%
  select(Sampling.Site, Phase, Mud, Styrene) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

sty$Sampling.Site <- as.factor(sty$Sampling.Site)
sty$Phase <- as.factor(sty$Phase)

# Run ANOVA
sty_anova = aov(Styrene ~ Sampling.Site * Phase, data = sty)
summary(sty_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(sty_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Styrene ~ Sampling.Site * Phase, data = sty)

# Log-transform and check distribution with histogram and tests
sty$log_Styrene <- log(sty$Styrene)
hist(sty)
leveneTest(log_Styrene ~ Sampling.Site * Phase, data = sty) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
sty_anova = aov(log_Styrene ~ Sampling.Site * Phase, data = sty)
summary(sty_anova)
capture.output(sty_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/styrene_anova_comm")

# Tukey's post-hoc
sty_tukey = TukeyHSD(x = sty_anova, conf.level = 0.95)
capture.output(sty_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/styrene_tukey_comm")
sty_tukey
```


#n.nonane
```{r}
# Clean data and filter for n.Nonane
nn = all_clean %>%
  select(Sampling.Site, Phase, Mud, n.Nonane) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

nn$Sampling.Site <- as.factor(nn$Sampling.Site)
nn$Phase <- as.factor(nn$Phase)

# Run ANOVA
nn_anova = aov(n.Nonane ~ Sampling.Site * Phase, data = nn)
summary(nn_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(nn_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(n.Nonane ~ Sampling.Site * Phase, data = nn)

# Log-transform and check distribution with histogram and tests
nn$log_n.Nonane <- log(nn$n.Nonane)
hist(nn)
leveneTest(log_n.Nonane ~ Sampling.Site * Phase, data = nn) # not sig anymore

# Re-run ANOVA with transformed values
nn_anova = aov(log_n.Nonane ~ Sampling.Site * Phase, data = nn)
summary(nn_anova)
capture.output(nn_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/nonane_anova_comm")

# Tukey's post-hoc
nn_tukey = TukeyHSD(x = nn_anova, conf.level = 0.95)
capture.output(nn_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/nonane_tukey_comm")
nn_tukey
```


#n.decane
```{r}
# Clean data and filter for n.Decane
nd = all_clean %>%
  select(Sampling.Site, Phase, Mud, n.Decane) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

nd$Sampling.Site <- as.factor(nd$Sampling.Site)
nd$Phase <- as.factor(nd$Phase)

# Run ANOVA
nd_anova = aov(n.Decane ~ Sampling.Site * Phase, data = nd)
summary(nd_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(nd_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(n.Decane ~ Sampling.Site * Phase, data = nd)

# Log-transform and check distribution with histogram and tests
nd$log_n.Decane <- log(nd$n.Decane)
hist(nd)
leveneTest(log_n.Decane ~ Sampling.Site * Phase, data = nd) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
nd_anova = aov(log_n.Decane ~ Sampling.Site * Phase, data = nd)
summary(nd_anova)
capture.output(nd_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/decane_anova_comm")

# Tukey's post-hoc
nd_tukey = TukeyHSD(x = nd_anova, conf.level = 0.95)
capture.output(nd_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/decane_tukey_comm")
nd_tukey

```


#TCE
```{r}
# Clean data and filter for TCE
tce = all_clean %>%
  select(Sampling.Site, Phase, Mud, TCE) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

tce$Sampling.Site <- as.factor(tce$Sampling.Site)
tce$Phase <- as.factor(tce$Phase)

# Run ANOVA
tce_anova = aov(TCE ~ Sampling.Site * Phase, data = tce)
summary(tce_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(tce_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(TCE ~ Sampling.Site * Phase, data = tce)

# Log-transform and check distribution with histogram and tests
tce$log_TCE <- log(tce$TCE)
hist(tce)
leveneTest(log_TCE ~ Sampling.Site * Phase, data = tce) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
tce_anova = aov(log_TCE ~ Sampling.Site * Phase, data = tce)
summary(tce_anova)
capture.output(tce_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/tce_anova_comm")

# Tukey's post-hoc
tce_tukey = TukeyHSD(x = tce_anova, conf.level = 0.95)
capture.output(tce_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/tce_tukey_comm")
tce_tukey

```



#PCE
```{r}
# Clean data and filter for PCE
PCE_data = all_clean %>%
  select(Sampling.Site, Phase, Mud, PCE) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

PCE_data$Sampling.Site <- as.factor(PCE_data$Sampling.Site)
PCE_data$Phase <- as.factor(PCE_data$Phase)

# Run ANOVA
PCE_anova = aov(PCE ~ Sampling.Site * Phase, data = PCE_data)
summary(PCE_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(PCE_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(PCE ~ Sampling.Site * Phase, data = PCE_data)

# Log-transform and check distribution with histogram and tests
PCE_data$log_PCE <- log(PCE_data$PCE)
hist(PCE_data)
leveneTest(log_PCE ~ Sampling.Site * Phase, data = PCE_data) # decreased p value and data not more normal, so using that for ANOVA

capture.output(PCE_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/PCE_anova_comm")

# Tukey's post-hoc
PCE_tukey = TukeyHSD(x = PCE_anova, conf.level = 0.95)
capture.output(PCE_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/PCE_tukey_comm")
PCE_tukey

```



#propene
```{r}
# Clean data and filter for Propene
pro = all_clean %>%
  select(Sampling.Site, Phase, Mud, Propene) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

pro$Sampling.Site <- as.factor(pro$Sampling.Site)
pro$Phase <- as.factor(pro$Phase)

# Run ANOVA
pro_anova = aov(Propene ~ Sampling.Site * Phase, data = pro)
summary(pro_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(pro_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Propene ~ Sampling.Site * Phase, data = pro)

# Log-transform and check distribution with histogram and tests
pro$log_Propene <- log(pro$Propene)
hist(pro)
leveneTest(log_Propene ~ Sampling.Site * Phase, data = pro) # decreased p value but data way more normalized, so using log transformed

# Re-run ANOVA with transformed values
pro_anova = aov(log_Propene ~ Sampling.Site * Phase, data = pro)
summary(pro_anova)
capture.output(pro_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/Propene_anova_comm")

# Tukey's post-hoc
pro_tukey = TukeyHSD(x = pro_anova, conf.level = 0.95)
capture.output(pro_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/Propene_tukey_comm")
pro_tukey

```



#aliphatic_low
```{r}
# Clean data and filter for Aliphatic_low
aliph = all_clean %>%
  select(Sampling.Site, Phase, Mud, Aliphatic_low) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

aliph$Sampling.Site <- as.factor(aliph$Sampling.Site)
aliph$Phase <- as.factor(aliph$Phase)

# Run ANOVA
aliph_anova = aov(Aliphatic_low ~ Sampling.Site * Phase, data = aliph)
summary(aliph_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(aliph_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Aliphatic_low ~ Sampling.Site * Phase, data = aliph)

# Log-transform and check distribution with histogram and tests
aliph$log_Aliphatic_low <- log(aliph$Aliphatic_low)
hist(aliph)
leveneTest(log_Aliphatic_low ~ Sampling.Site * Phase, data = aliph) # Reduced by orders of magnitude, so good enough

# Re-run ANOVA with transformed values
aliph_anova = aov(log_Aliphatic_low ~ Sampling.Site * Phase, data = aliph)
summary(aliph_anova)
capture.output(aliph_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/Aliphatic_low_anova_comm")

# Tukey's post-hoc
aliph_tukey = TukeyHSD(x = aliph_anova, conf.level = 0.95)
capture.output(aliph_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/Aliphatic_low_tukey_comm")
aliph_tukey

```


#aromatic_medium
```{r}
# Clean data and filter for Aromatic_medium
aro = all_clean %>%
  select(Sampling.Site, Phase, Mud, Aromatic_medium) %>%
  filter(Sampling.Site == "Wildgrass" | Sampling.Site == "Anthem")

aro$Sampling.Site <- as.factor(aro$Sampling.Site)
aro$Phase <- as.factor(aro$Phase)

# Run ANOVA
aro_anova = aov(Aromatic_medium ~ Sampling.Site * Phase, data = aro)
summary(aro_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(aro_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Aromatic_medium ~ Sampling.Site * Phase, data = aro)

# Log-transform and check distribution with histogram and tests
aro$log_Aromatic_medium <- log(aro$Aromatic_medium)
hist(aro)
leveneTest(log_Aromatic_medium ~ Sampling.Site * Phase, data = aro) # p value decreased and data not much more normal so using original values

capture.output(aro_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/Aromatic_medium_anova_comm")

# Tukey's post-hoc
aro_tukey = TukeyHSD(x = aro_anova, conf.level = 0.95)
capture.output(aro_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/Aromatic_medium_tukey_comm")
aro_tukey

```


## mud statistics

#benzene
```{r}
# Clean data and filter for Benzene
ben = all_clean %>%
  select(Sampling.Site, Phase, Mud, Benzene) %>%
  filter(Phase == "drilling")

ben$Sampling.Site <- as.factor(ben$Sampling.Site)
ben$Mud <- as.factor(ben$Mud)

# Run ANOVA
ben_anova = aov(Benzene ~ Sampling.Site * Mud, data = ben)
summary(ben_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(ben_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Benzene ~ Sampling.Site * Mud, data = ben)

# Log-transform and check distribution with histogram and tests
ben$log_Benzene <- log(ben$Benzene)
hist(ben)
leveneTest(log_Benzene ~ Sampling.Site * Mud, data = ben) # not significant anymore

# Re-run ANOVA with transformed values
ben_anova = aov(log_Benzene ~ Sampling.Site * Mud, data = ben)
summary(ben_anova)
capture.output(ben_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/benzene_anova_mud")

# Tukey's post-hoc
ben_tukey = TukeyHSD(x = ben_anova, conf.level = 0.95)
capture.output(ben_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/benzene_tukey_mud")
ben_tukey
```


#toluene
```{r}
# Clean data and filter for Toluene
tol = all_clean %>%
  select(Sampling.Site, Phase, Mud, Toluene) %>%
  filter(Phase == "drilling")

tol$Sampling.Site <- as.factor(tol$Sampling.Site)
tol$Mud <- as.factor(tol$Mud)

# Run ANOVA
tol_anova = aov(Toluene ~ Sampling.Site * Mud, data = tol)
summary(tol_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(tol_anova$residuals)

# Levene's Test for homogeneity of variances (p > 0.05, variances are homogenous)
leveneTest(Toluene ~ Sampling.Site * Mud, data = tol)

# Log-transform and check distribution with histogram and tests
tol$log_Toluene <- log(tol$Toluene)
hist(tol)
leveneTest(log_Toluene ~ Sampling.Site * Mud, data = tol) # no change but data more normal, so transforming

# Re-run ANOVA with transformed values
tol_anova = aov(log_Toluene ~ Sampling.Site * Mud, data = tol)
summary(tol_anova)
capture.output(tol_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/toluene_anova_mud")

# Tukey's post-hoc
tol_tukey = TukeyHSD(x = tol_anova, conf.level = 0.95)
capture.output(tol_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/toluene_tukey_mud")
tol_tukey

```


#ethylbenzene
```{r}
# Clean data and filter for Ethylbenzene
eb = all_clean %>%
  select(Sampling.Site, Phase, Mud, Ethylbenzene) %>%
  filter(Phase == "drilling")

eb$Sampling.Site <- as.factor(eb$Sampling.Site)
eb$Mud <- as.factor(eb$Mud)

# Run ANOVA
eb_anova = aov(Ethylbenzene ~ Sampling.Site * Mud, data = eb)
summary(eb_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(eb_anova$residuals)

# Levene's Test for homogeneity of variances (p > 0.05, variances are homogenous)
leveneTest(Ethylbenzene ~ Sampling.Site * Mud, data = eb)

# Log-transform and check distribution with histogram and tests
eb$log_Ethylbenzene <- log(eb$Ethylbenzene)
hist(eb)
leveneTest(log_Ethylbenzene ~ Sampling.Site * Mud, data = eb) # no change but data more normal, so transforming

# Re-run ANOVA with transformed values
eb_anova = aov(log_Ethylbenzene ~ Sampling.Site * Mud, data = eb)
summary(eb_anova)
capture.output(eb_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/ethylbenzene_anova_mud")

# Tukey's post-hoc
eb_tukey = TukeyHSD(x = eb_anova, conf.level = 0.95)
capture.output(eb_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/ethylbenzene_tukey_mud")
eb_tukey

```


#xylenes
```{r}
# Clean data and filter for Xylenes
xyl = all_clean %>%
  select(Sampling.Site, Phase, Mud, Xylenes) %>%
  filter(Phase == "drilling")

xyl$Sampling.Site <- as.factor(xyl$Sampling.Site)
xyl$Mud <- as.factor(xyl$Mud)

# Run ANOVA
xyl_anova = aov(Xylenes ~ Sampling.Site * Mud, data = xyl)
summary(xyl_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(xyl_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Xylenes ~ Sampling.Site * Mud, data = xyl)

# Log-transform and check distribution with histogram and tests
xyl$log_Xylenes <- log(xyl$Xylenes)
hist(xyl)
leveneTest(log_Xylenes ~ Sampling.Site * Mud, data = xyl) # no change but data more normal, so transforming

# Re-run ANOVA with transformed values
xyl_anova = aov(log_Xylenes ~ Sampling.Site * Mud, data = xyl)
summary(xyl_anova)
capture.output(xyl_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/xylenes_anova_mud")

# Tukey's post-hoc
xyl_tukey = TukeyHSD(x = xyl_anova, conf.level = 0.95)
capture.output(xyl_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/xylenes_tukey_mud")
xyl_tukey

```



#styrene: no gibson to compare


#n.nonane
```{r}
# Clean data and filter for n.Nonane
nn = all_clean %>%
  select(Sampling.Site, Phase, Mud, n.Nonane) %>%
  filter(Phase == "drilling")

nn$Sampling.Site <- as.factor(nn$Sampling.Site)
nn$Mud <- as.factor(nn$Mud)

# Run ANOVA
nn_anova = aov(n.Nonane ~ Sampling.Site * Mud, data = nn)
summary(nn_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(nn_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(n.Nonane ~ Sampling.Site * Mud, data = nn)

# Log-transform and check distribution with histogram and tests
nn$log_n.Nonane <- log(nn$n.Nonane)
hist(nn)
leveneTest(log_n.Nonane ~ Sampling.Site * Mud, data = nn) # not sig anymore

# Re-run ANOVA with transformed values
nn_anova = aov(log_n.Nonane ~ Sampling.Site * Mud, data = nn)
summary(nn_anova)
capture.output(nn_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/nonane_anova_mud")

# Tukey's post-hoc
nn_tukey = TukeyHSD(x = nn_anova, conf.level = 0.95)
capture.output(nn_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/nonane_tukey_mud")
nn_tukey

```


#n.decane
```{r}
# Clean data and filter for n.Decane
nd = all_clean %>%
  select(Sampling.Site, Phase, Mud, n.Decane) %>%
  filter(Phase == "drilling")

nd$Sampling.Site <- as.factor(nd$Sampling.Site)
nd$Mud <- as.factor(nd$Mud)

# Run ANOVA
nd_anova = aov(n.Decane ~ Sampling.Site * Mud, data = nd)
summary(nd_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(nd_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(n.Decane ~ Sampling.Site * Mud, data = nd)

# Log-transform and check distribution with histogram and tests
nd$log_n.Decane <- log(nd$n.Decane)
hist(nd)
leveneTest(log_n.Decane ~ Sampling.Site * Mud, data = nd) # not sig anymore

# Re-run ANOVA with transformed values
nd_anova = aov(log_n.Decane ~ Sampling.Site * Mud, data = nd)
summary(nd_anova)
capture.output(nd_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/decane_anova_mud")

# Tukey's post-hoc
nd_tukey = TukeyHSD(x = nd_anova, conf.level = 0.95)
capture.output(nd_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/decane_tukey_mud")
nd_tukey

```

#TCE
```{r}
# Clean data and filter for TCE
tce = all_clean %>%
  select(Sampling.Site, Phase, Mud, TCE) %>%
  filter(Phase == "drilling")

tce$Sampling.Site <- as.factor(tce$Sampling.Site)
tce$Mud <- as.factor(tce$Mud)

# Run ANOVA
tce_anova = aov(TCE ~ Sampling.Site * Mud, data = tce)
summary(tce_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(tce_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(TCE ~ Sampling.Site * Mud, data = tce)

# Log-transform and check distribution with histogram and tests
tce$log_TCE <- log(tce$TCE)
hist(tce)
leveneTest(log_TCE ~ Sampling.Site * Mud, data = tce) # not sig anymore

# Re-run ANOVA with transformed values
tce_anova = aov(log_TCE ~ Sampling.Site * Mud, data = tce)
summary(tce_anova)
capture.output(tce_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/tce_anova_mud")

# Tukey's post-hoc
tce_tukey = TukeyHSD(x = tce_anova, conf.level = 0.95)
capture.output(tce_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/tce_tukey_mud")
tce_tukey

```

#PCE
```{r}
# Clean data and filter for PCE
pce = all_clean %>%
  select(Sampling.Site, Phase, Mud, PCE) %>%
  filter(Phase == "drilling")

pce$Sampling.Site <- as.factor(pce$Sampling.Site)
pce$Mud <- as.factor(pce$Mud)

# Run ANOVA
pce_anova = aov(PCE ~ Sampling.Site * Mud, data = pce)
summary(pce_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(pce_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(PCE ~ Sampling.Site * Mud, data = pce)

# Log-transform and check distribution with histogram and tests
pce$log_PCE <- log(pce$PCE)
hist(pce)
leveneTest(log_PCE ~ Sampling.Site * Mud, data = pce) # no change but data more normal, so transforming

# Re-run ANOVA with transformed values
pce_anova = aov(log_PCE ~ Sampling.Site * Mud, data = pce)
summary(pce_anova)
capture.output(pce_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/pce_anova_mud")

# Tukey's post-hoc
pce_tukey = TukeyHSD(x = pce_anova, conf.level = 0.95)
capture.output(pce_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/pce_tukey_mud")
pce_tukey

```


#propene
```{r}
# Clean data and filter for Propene
pro = all_clean %>%
  select(Sampling.Site, Phase, Mud, Propene) %>%
  filter(Phase == "drilling")

pro$Sampling.Site <- as.factor(pro$Sampling.Site)
pro$Mud <- as.factor(pro$Mud)

# Run ANOVA
pro_anova = aov(Propene ~ Sampling.Site * Mud, data = pro)
summary(pro_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(pro_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Propene ~ Sampling.Site * Mud, data = pro)

# Log-transform and check distribution with histogram and tests
pro$log_Propene <- log(pro$Propene)
hist(pro)
leveneTest(log_Propene ~ Sampling.Site * Mud, data = pro) # not sig anymore

# Re-run ANOVA with transformed values
pro_anova = aov(log_Propene ~ Sampling.Site * Mud, data = pro)
summary(pro_anova)
capture.output(pro_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/propene_anova_mud")

# Tukey's post-hoc
pro_tukey = TukeyHSD(x = pro_anova, conf.level = 0.95)
capture.output(pro_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/propene_tukey_mud")
pro_tukey

```


#aliphatic low
```{r}
# Clean data and filter for Aliphatic_low
aliph = all_clean %>%
  select(Sampling.Site, Phase, Mud, Aliphatic_low) %>%
  filter(Phase == "drilling")

aliph$Sampling.Site <- as.factor(aliph$Sampling.Site)
aliph$Mud <- as.factor(aliph$Mud)

# Run ANOVA
aliph_anova = aov(Aliphatic_low ~ Sampling.Site * Mud, data = aliph)
summary(aliph_anova)

# Shapiro-Wilk test for normality (p < 0.05, data is not normally distributed)
shapiro.test(aliph_anova$residuals)

# Levene's Test for homogeneity of variances (p < 0.05, variances are not homogenous)
leveneTest(Aliphatic_low ~ Sampling.Site * Mud, data = aliph)

# Log-transform and check distribution with histogram and tests
aliph$log_Aliphatic_low <- log(aliph$Aliphatic_low)
hist(aliph)
leveneTest(log_Aliphatic_low ~ Sampling.Site * Mud, data = aliph) # not sig anymore

# Re-run ANOVA with transformed values
aliph_anova = aov(log_Aliphatic_low ~ Sampling.Site * Mud, data = aliph)
summary(aliph_anova)
capture.output(aliph_anova, file = "~/CO_CRA/CO_CRA/Output/Air_Data/aliphatic_low_anova_mud")

# Tukey's post-hoc
aliph_tukey = TukeyHSD(x = aliph_anova, conf.level = 0.95)
capture.output(aliph_tukey, file = "~/CO_CRA/CO_CRA/Output/Air_Data/aliphatic_low_tukey_mud")
aliph_tukey

```

#aromatic medium: no gibson to compare


## descriptive statistics tables ##

#add ozone to include in tables
```{r}
# Convert date columns to date class
all$Start.Date.Time <- as.Date(all$Start.Date.Time)
all$Stop.Date.Time <- as.Date(all$Stop.Date.Time)
ozone$Date.Local <- as.Date(ozone$Date.Local)

# Initialize an empty dataframe to store the results
ozone_filtered <- data.frame()

# Iterate over each row in the 'all' dataframe
for (i in 1:nrow(all)) {
  start_date <- all$Start.Date.Time[i]
  stop_date <- all$Stop.Date.Time[i]
  
  # Filter ozone dataframe for the date range
  filtered_ozone <- ozone %>%
    filter(Date.Local >= start_date & Date.Local <= stop_date) %>%
    mutate(Sampling.Site = all$Sampling.Site[i],
           Phase = all$Phase[i])
  
  # Bind the filtered results to the ozone_filtered dataframe
  ozone_filtered <- bind_rows(ozone_filtered, filtered_ozone)
}

# Select and rename columns in ozone_filtered dataframe
ozone_filtered <- ozone_filtered %>%
  select(Date.Local, Sampling.Site, Phase, Arithmetic.Mean) %>%
  rename(Date = Date.Local, Ozone = Arithmetic.Mean)

# Multiply the Ozone column by 1000 to convert to ppb
ozone_filtered <- ozone_filtered %>%
  mutate(Ozone = Ozone * 1000)
```


#summary stats by site type (community, O&G) for VOCs
```{r}

# Create the Site_Type column
all <- all %>%
  mutate(Site_Type = case_when(
    Sampling.Site %in% c("Northwest", "Interchange", "United", "Livingston") ~ "O&G Sites",
    Sampling.Site %in% c("Anthem", "Soaring Eagle") ~ "Community Sites",
    Sampling.Site == "Commons" ~ "Commons",
    TRUE ~ "Other"
  )) %>%
  filter(Site_Type != "Other")

# Calculate summary statistics
summary_stats <- all %>%
  group_by(Site_Type) %>%
  summarize(across(where(is.numeric), list(
    n = ~ sum(!is.na(.)),
    min = ~ min(., na.rm = TRUE),
    mean = ~ mean(., na.rm = TRUE),
    median = ~ median(., na.rm = TRUE),
    max = ~ max(., na.rm = TRUE),
    sd = ~ sd(., na.rm = TRUE),
    se = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.)))
  ), .names = "{.col}_{.fn}"))

# Reshape the dataframe to the desired format
reshaped_stats <- summary_stats %>%
  pivot_longer(
    cols = -Site_Type,
    names_to = "Chemical_Statistic",
    values_to = "Value"
  ) %>%
  separate(Chemical_Statistic, into = c("Chemical", "Statistic"), sep = "_(?=[^_]+$)") %>%
  pivot_wider(
    names_from = c(Site_Type, Statistic),
    values_from = Value,
    names_glue = "{Site_Type}_{Statistic}"
  )

#save as csv
write.csv(reshaped_stats, file = "~/CO_CRA/CO_CRA/Output/Air_Data/weekly_summary_stats_type_VOCs.csv")

```


#summary stats by site type for ozone
```{r}

# Create the Site_Type column
ozone_filtered <- ozone_filtered %>%
  mutate(Site_Type = case_when(
    Sampling.Site %in% c("Northwest", "Interchange", "United", "Livingston") ~ "O&G Sites",
    Sampling.Site %in% c("Anthem", "Soaring Eagle") ~ "Community Sites",
    Sampling.Site == "Commons" ~ "Commons",
    TRUE ~ "Other"
  )) %>%
  filter(Site_Type != "Other")

# Calculate summary statistics
summary_stats <- ozone_filtered %>%
  group_by(Site_Type) %>%
  summarize(across(Ozone, list(
    n = ~ sum(!is.na(.)),
    min = ~ min(., na.rm = TRUE),
    mean = ~ mean(., na.rm = TRUE),
    median = ~ median(., na.rm = TRUE),
    max = ~ max(., na.rm = TRUE),
    sd = ~ sd(., na.rm = TRUE),
    se = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.)))
  ), .names = "{.col}_{.fn}"))

# Reshape the dataframe to the desired format
reshaped_stats <- summary_stats %>%
  pivot_longer(
    cols = -Site_Type,
    names_to = "Chemical_Statistic",
    values_to = "Value"
  ) %>%
  separate(Chemical_Statistic, into = c("Chemical", "Statistic"), sep = "_(?=[^_]+$)") %>%
  pivot_wider(
    names_from = c(Site_Type, Statistic),
    values_from = Value,
    names_glue = "{Site_Type}_{Statistic}"
  )

# Save as CSV
write.csv(reshaped_stats, file = "~/CO_CRA/CO_CRA/Output/Air_Data/weekly_summary_stats_type_ozone.csv")

```



#summary stats by phase for VOCs
```{r}
# Calculate summary statistics grouped by Phase
summary_stats_phase <- all %>%
  group_by(Phase) %>%
  summarize(across(where(is.numeric), list(
    n = ~ sum(!is.na(.)),
    min = ~ min(., na.rm = TRUE),
    mean = ~ mean(., na.rm = TRUE),
    median = ~ median(., na.rm = TRUE),
    max = ~ max(., na.rm = TRUE),
    sd = ~ sd(., na.rm = TRUE),
    se = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.)))
  ), .names = "{.col}_{.fn}"))

# Reshape the dataframe to the desired format
reshaped_stats_phase <- summary_stats_phase %>%
  pivot_longer(
    cols = -Phase,
    names_to = "Chemical_Statistic",
    values_to = "Value"
  ) %>%
  separate(Chemical_Statistic, into = c("Chemical", "Statistic"), sep = "_(?=[^_]+$)") %>%
  pivot_wider(
    names_from = c(Phase, Statistic),
    values_from = Value,
    names_glue = "{Phase}_{Statistic}"
  )

#save as csv
write.csv(reshaped_stats_phase, file = "~/CO_CRA/CO_CRA/Output/Air_Data/weekly_summary_stats_phase_VOCs.csv")

```



#summary stats by phase for ozone
```{r}
# Calculate summary statistics grouped by Phase
summary_stats_phase <- ozone_filtered %>%
  group_by(Phase) %>%
  summarize(across(Ozone, list(
    n = ~ sum(!is.na(.)),
    min = ~ min(., na.rm = TRUE),
    mean = ~ mean(., na.rm = TRUE),
    median = ~ median(., na.rm = TRUE),
    max = ~ max(., na.rm = TRUE),
    sd = ~ sd(., na.rm = TRUE),
    se = ~ sd(., na.rm = TRUE) / sqrt(sum(!is.na(.)))
  ), .names = "{.col}_{.fn}"))

# Reshape the dataframe to the desired format
reshaped_stats_phase <- summary_stats_phase %>%
  pivot_longer(
    cols = -Phase,
    names_to = "Chemical_Statistic",
    values_to = "Value"
  ) %>%
  separate(Chemical_Statistic, into = c("Chemical", "Statistic"), sep = "_(?=[^_]+$)") %>%
  pivot_wider(
    names_from = c(Phase, Statistic),
    values_from = Value,
    names_glue = "{Phase}_{Statistic}"
  )

# Save as CSV
write.csv(reshaped_stats_phase, file = "~/CO_CRA/CO_CRA/Output/Air_Data/weekly_summary_stats_phase_ozone.csv")
```



